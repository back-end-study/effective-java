# Item56. 공개된 API 요소에는 항상 문서와 주석을 작성하라

## javadoc

Java 소스 코드에서 HTML 형식의 API 문서를 생성하기위한 문서 생성기 
주석이라는 형태로 기술된 설명을 추출해 API 문서로 변환해준다.



## 주석의 규칙

API 문서화 주석 작성규칙이 언어 명세에는 속하지않고
문서화 하는방법은 컨벤션에 따라 다르고 여러 문서화 방법중 하나에 불과하지만 업계 표준 API라고 할수있다.


- **API를 올바로 문서화하려면 공개된 모든 클래스, 인터페이스, 메서드, 필드선언에 문서화 주석을 달아야한다**
 - 직렬화 할수있는 클래스라면 직렬화 형태에 관해서도 적어야한다.
- 공개 클래스는 기본 생성자에 주석을 달 수 있는 방법이 없으니 절대 기본 생성자를 사용해서는 안된다.
 
- **메서드용 문서화 주석에는 해당 메서드와 클라이언트 사이의 규약을 명료하게 기술해야한다**

- **상속용으로 설계된 클래스의 메서드가 아니라면 how가 아닌 what을 기술해야한다**

- 메서드를 호출하기위한 전제조건을 모두 나열해야한다

- 메서드가 성공적으로 수행된 후에 만족해야하는 사후조건도  나열해야한다

![](https://velog.velcdn.com/images/rodlsdyd/post/1c0a1b5e-01a4-4822-8ba0-6157c577a79c/image.png)


- @throws 태그로 uncheckedException을 기술한다
- @param 태그로 매개변수에 대해 기술한다.
- @return 태그도 메서드의 설명과 다르지않다면 기술한다 
  - jdk16에 @{@Return} 태그가 추가되어 반복설명 하게되는 부분을 줄일 수 있습니다.
  
```java

/**
* Foo를 반환합니다
  @return 푸 
*/
 Foo getFoo()
 
 //jdk 16
 
 /**
* {@Returns} a Foo
*/
 Foo getFoo()
 
 
```
- 부작용도 문서화 해야한다(백그라운드 스레드를 시작시키는 메서드)

>  Thread.stop으로 스레드를 중지하면 잠긴 모든 모니터의 잠금이 해제됩니다.    
>  이러한 모니터에 의해 이전에 보호되었던 개체가 일관성 없는 상태인 경우 손상된 개체가 다른 스레드에 표시되어 잠재적으로 임의의 동작이 발생할 수 있습니다.......    
>  java.lang.Thread

- 관례상 @param, @return, @throws 태그의 설명에는 마침표를 붙이지 않는다.



## javadoc 태그

#### {@code}
- 감싼 내용을 코드용 폰트로 렌더링한다
- 감싼 내용에 포함된 HTML요소, 다른 자바독 태그를 무시한다

#### @implSpec

- 해당메서드와 하위클래스 사이의 계약을 설명한다.
  - 하위클래스들이 메서드를 상속하거나 super키워드를 사용할때 어떻게 동작하는지 인지시키기 위함이다.
 
  
- @implSpec 태그는 선택값이라 활성화하려면 
-tag "implSpec:a:Implementation Requirements:"를 지정해주어야 한다. (JDK19에도 여전한듯하다)


#### {@literal}

- @code와 비슷하지만 코드 폰트로 렌더링하지않고 <,>, 등의 HTML 메타문자를 포함시킬수 있다.

```java
/**
 * 이 컬렉션이 비었다면 true를 반환한다.
 * 
 * @implSpec 
 * 이 구현은 {@code this.size() == 0}의 결과를 반환한다.
 * 
 * @return 이 컬렉션이 비었다면 true, 그렇지 않다면 false
 */
```

#### 마침표 주의

```java
/**
 * 머스터드 대령이나 Mrs. 피콕 같은 용의자.
 * 
 * 최종 HTML에는 '머스터드 대령이나 Mrs.' 까지만 나온다.
 */
```
좋은 해결책은 {@literal}로 텍스트를 감싸주는것. 
```java
/**
 * 머스터드 대령이나 {@literal Mrs. 피콕} 같은 용의자.
 */
 
// jdk10의 {@summary}

/**
 *  {@summary 머스터드 대령이나  Mrs. 피콕 같은 용의자.}
 */
```
자바 10부터는 @summary 태그 추가 

#### 검색 개선..
jdk9 이전
![](https://velog.velcdn.com/images/rodlsdyd/post/27a8fccf-49a1-4e72-aacc-d746eb559a51/image.png)


jdk9에서 검색기능 추가 
![](https://velog.velcdn.com/images/rodlsdyd/post/55fdb504-528f-4c28-a417-7d3179f280f6/image.png)

```java
/**
 * This method compiles with the {@index IEEE 754} standard
 */
```
색인을 할수도있다.

### 제네릭, Enum, 애너테이션 

제네릭
- 모든 타입매개변수에 주석을 달아라 

```java
/**
 * 키와 값을 매핑하는 객체, 맵은 키를 중복해서 가질 수 없다
 * 즉, 키 하나가 가리킬 수 있는 값은 최대 1개다.
 * 
 * @param <K> 이 맵이 관리하는 키의 타입
 * @param <V> 매핑된 값의 타입
 */
public interface Map<K, V> { ... }
```

열거타입
- 열거타입자체, public메서드는 물론이고 상수들에도 주석을 달아라 
```java
/**
 * 심포니 오케스트라의 악기 세션
 */
public enum OrchestraSection {
    /** 플루트, 클라리넷, 오보 같은 목관악기. */
    WOODWIND,
  
    /** 프렌치 호른, 트럼펫 같은 금관악기 */
    BRASS,
  
    /** 탐파니, 심벌즈 같은 타악기 */
    PERCUSSION,
  
    /** 바이올린, 첼로 같은 현악기 */
    STRING
}
```

애너테이션

- 애너테이션 타입 자체도 물론이고 멤버들에게 모두 주석을 달아라

- 필드 설명은 명사구로 해라
- 이 애너테이션을 단다는것이 어떤의미인지 설명을할때는 동사구로 해라 
```java
/**
 * 이 주석이 달린 메서드는 명시한 예외를 던져야만 성공하는
 * 테스트 메서드임을 나타낸다.
 */
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface ExceptionTest {
    /**
     * 이 주석을 단 테스트 메서드가 성공하려면 던져야 하는 예외
     * (이 클래스의 하위 타입 예외는 모두 허용된다.)
     */
    Class<? extends Throwable> value();
}
```

- 패키지를 설명하는 문서화 주석은 package-info.java 파일에  패키지선언을 반드시 포함한후 작성..

- 모듈관련 설명은 module-info.java 파일에 작성

### 스레드 안정성, 직렬화 가능성

- 클래스 혹은 정적 메서드가 스레드 안전하든 그렇지 않든, 스레드 안전 수준을 반드시 API 설명에 포함해야 한다.
=> 뒤에서 다룸

- 직렬화 가능한 클래스라면 직렬화 형태도 API 설명에 기술해야 한다. (@serial 태그를 활용해볼 수 있다.)
=> 뒤에서 다룸


### Javadoc 상속

- 문서화 주석이 없는 API 요소를 발견하면 Javadoc이 가장 가까운 문서화 주석을 찾아준다. 
  - 상위 클래스보다 그 클래스가 구현한 인터페이스를 먼저 찾는다. 


메소드 주석 상속 알고리즘

> 1. 메소드에 문서 주석이 없거나 {@inheritDoc} 태그가 있는 경우 Javadoc 도구는 가장 구체적인 적용 가능한 문서 주석을 찾도록 설계된 다음 알고리즘을 사용하여 적용 가능한 주석을 검색합니다.    
> 부모클래스보다 인터페이스를 우선시합니다.   
직접 구현된(또는 확장된) 각 인터페이스를 메서드 선언에서 implements(또는 extends)라는 단어 다음에 나타나는 순서대로 살펴봅니다.   
이 방법으로 찾은 첫번째 메서드 주석을 사용합니다.      

> 2. 1단계에서 문서화 주석을 찾지 못하면 이 전체 알고리즘을 1단계에서 검사한 것과 동일한 순서로 직접 구현(또는 확장)된 각 인터페이스에 재귀적으로 적용합니다.   
> ....   3단계, 4단계 .....   
> https://docs.oracle.com/javase/7/docs/technotes/tools/windows/javadoc.html    
> The Javadoc Reference Guide

### 링크
- 복잡한 API라면 문서화주석 외에도 관련 클래스나 패키지의 문서화 주석에서 그 문서의 링크를 제공하는것도 좋다.

- ~~자바 9, 10의 자바독은 명령줄에서 -html5 스위치를 켜면 HTML5 버전으로 만들어준다.~~
=> JDK 11부터는 HTML5이 기본값으로 생성

- 자바독 작성 권장사항에 대해 검사해주는 기능을 제공하기도 하고, IDE플러그인도 지원한다.
